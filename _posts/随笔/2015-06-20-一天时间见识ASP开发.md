---
layout: post
title: "一天时间见识ASP开发"
description: ""
category: 随笔
tags: []
---

{% include JB/setup %}

我们生活在最好的时代，因为一切事物都有现成的工具帮你完成。

我们也生活在最坏的时代，因为一切事物都早已有现成的工具帮你完成。

——我国著名的无名人士：宋建鑫

事情的起因是学电子商务的朱同学要完成做网页的作业，要写一个能管理用户注册、登录，且能判断用户是否已登录的动态网页。

我之前只走马观花的看过一点HTML、CSS、JS，让我用一个从来没用过的工具在从来没见过的环境下写一个网页，我肯定是拒绝的，但盛情难却，我又找不到其他会的同学帮忙，硬着头皮开始边学边做。

要求：

1.  用ASP写网页（以前就没听过）
2.  用IIS服务器（没听说过+1）
3.  要使用ACCESS数据库（知道，没用过）
4.  能完成用户注册、登录（嗯……）
5.  等判断当前用户是否在线（这个我想对了头，用cookies）

完全依赖曹旻老师讲过的一点理论知识（就是”啥都是工具，没啥玄机“的自我安慰），摸索着做了起来。抄网上的代码，借用博客用的样式模板，无恶不作。

曹旻老师是对的，啥都是工具，ASP是工具，IIS是工具，ACCESS是工具，都是工具，工具意味着，想用得好不简单，但想用上手还是很简单的。一天时间不到，从完全不会，到完成任务，说难也不难，一切事物都有现成的工具。

突然领悟了杨瑒学长的话的用意，做太多不同不痒的项目是浪费时间，有些项目无非就是在学习如果使用这个工具，那个工具，但我如果能将某一样东西（无论是工具还是理论）用得炉火纯青，一切事物都可以万法归一的——我之所以能想到利用cookies判断当前用户是否在线，是跟着曹旻老师学C#时，受到的一点启发，虽然可能不成熟，但是有用。

大道理就说到这儿吧，记一下本次历险遇到的困难和解决办法，以后会有用的。

### A. 数据库打开失败
数据库文件和临时文件所在的文件夹开放的权限不够：

设置C:\Windows\Temp的权限，增加Authenticated Users，给予完全控制；

设置ASP程序包文件夹的权限，增加Authenticated Users，给予完全控制；

windows7 64位系统默认没有JET数据库打开工具

在IIS里，把线程池里所用的线程的32位兼容打开，记得是在这儿，回头确认下。

### B. response.write()输出中文乱码
在文件头添加代码：
`<%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%>`

### C. 打开数据库模式有读/写两种模式
读是：`rsc.open sqlc,conn` 或 `rsc.open sqlc,conn，1,1`
写是：`rsc.open sqlc,conn，1,3`

然而并不知道其所依然，没系统学数据库。

### D.打开IIS的调试

一开始我并不知道IIS有调试功能，导致我代码一除错便只能看到一行简单的提示说一个错误发生了，不过还好Visual Studio能够捕捉并调试发生的错误，但这完全是仰仗着机器装了这个大家伙。后来得知IIS是可以开启调试功能的，如图

![开启IIS调试.jpg]({{ site.url }}/images/2015-06-20-一天时间见识ASP开发/开启IIS调试.jpg)

***

差不多了。

代码托管到GitHub上了，不过可能哪一天我就把这个赶工之作删了:[*ASPUserManagement* on GitHub](https://github.com/wolfogre/ASPUserManagement)

工具越是多，越要静下心来学真本事。

晚安世界。








